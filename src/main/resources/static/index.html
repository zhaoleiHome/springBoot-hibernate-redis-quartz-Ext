<!DOCTYPE html>
<html lang="en">
<html  xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <script src=".\Ext JSv6.0.1Commercial\build\ext-all.js"></script>
    <link href=".\Ext JSv6.0.1Commercial\build\classic\theme-classic\resources\theme-classic-all.css" rel="stylesheet">
    <style>
        .button{
            background-color: #00BFFF;
            border: 1px;
            color: white;
            margin-left: 30px;
        }
        .delete_button{
            background-color: red;
            border: 1px;
            color: white;
            margin-left: 30px;
        }
        .down_button{
            background-color: #0BA2FF;
            border: 1px;
            color: white;
            margin-left: 30px;
        }
        .indexPanel{
            font-size: 30px;
            text-align: center;
            margin-top: 16%;
            color: 	#B4B4B4;
        }
        #weather{
            font-size: 15px;
            text-align: left;
            color: 	#B4B4B4;
            margin-left: 46%;
        }
    </style>
</head>
<body>
</body>
<script src="component/component.js"></script>
<script type="text/javascript">
    Ext.onReady(function () {
        Ext.create("Ext.container.Viewport",{
            layout : "border",
            items :[
                {
                    region : "west",
                    xtype : "treePanel",
                    width :"15%"
                },
                {
                  region : "east",
                  xtype : "panel",
                  width : "85%",
                  title : "首页",
                  id : "index",
                  html : "<div class='indexPanel' id='date'></div>"
                },
                {
                  region : "east",
                  xtype : "panel",
                  id : "note_panel",
                  hidden : true,
                  width : "85%",
                  height : "100%",
                  autoScroll:true,
                  items : [
                      {
                          xtype:"item_note",
                      },
                      {
                          xtype : "item_grid"
                      }
                  ],
                    bbar: {
                        xtype: 'pagingtoolbar',
                        store: store,   // GridPanel中使用的数据
                        dock: 'bottom',
                        displayInfo: true
                    }

                },
                {
                    region : "east",
                    xtype : "panel",
                    id : "todo_item_panel",
                    hidden : true,
                    width : "85%",
                    layout :"border",
                    items:[
                        {
                            region : "north",
                            xtype : "todo_item",
                            title : "工具栏"
                        },
                        {
                            region : "west",
                            xtype : "todo_item_grid",
                            width : "50%"
                         },
                         {
                             region : "east",
                             xtype : "todo_item_grid_ed",
                             width : "50%"
                          }
                    ]
                }
            ]

        })
        var weatherZ = null;
        var city =null
        var temp1 =null
        var temp2 = null
        var detail =null
        var weather_info = null
        getWeatherInfo();
        console.log(weather_info)
        var dateFormat = Ext.util.Format.date(new Date(),"Y-m-d H:i:s");
        document.getElementById('date').innerHTML="欢迎，赵磊<br/>现在时间："+dateFormat+"<br/>天气信息：<br/>"
        setInterval(createDateTime, 1000);
        setInterval(getWeatherInfo,1000*60*20)
        function createDateTime(){
            document.getElementById('date').innerHTML="欢迎，赵磊<br/>现在时间："+Ext.util.Format.date(new Date(),"Y-m-d H:i:s")+"<br/>天气：<br/><div id='weather'>" +
                weather_info +
                "</div>";
        }
        function getWeatherInfo(){
            weatherZ = null;
            console.log("向后端后去最新的天气情况")
            Ext.Ajax.request({
                url: "/get-weather",
                method: 'GET',
                async: false,
                success: function (response) {
                    var json =JSON.parse(response.responseText)
                    weatherZ = JSON.parse(json.data[0].weather_info)
                },
                failure: function (response) {
                    console.log(response.responseText)
                }
            });
            city = weatherZ.weatherinfo.city;
            temp1 = weatherZ.weatherinfo.temp1;
            temp2 = weatherZ.weatherinfo.temp2;
            detail = weatherZ.weatherinfo.weather
            weather_info = "地区："+city+"<br>温度："+temp1+"--"+temp2+"<br/>天气状况："+detail
        }
    })
</script>
</html>
